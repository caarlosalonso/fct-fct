<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <link rel="stylesheet" href="/styles/global.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>
    <!--<script type="module" src="/scripts/global.js"></script>-->

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página principal - Coordinación</title>

    <link rel="stylesheet" href="/styles/coordinacion.css">
</head>
<body>
    <header>

    </header>
    <main>
  <style>
    #ciclos-section {
      padding: 20px;
      width: 90%;
      background-color: orange;
        overflow: hidden;
    }

    #ciclos-container {
      overflow-x: auto;
      overflow-y: hidden;
      width: 100%;
      max-width: 100%;
          scrollbar-width: none;
    -ms-overflow-style: none;

    &::-webkit-scrollbar {
        display: none;
    }
    }

    .sticky-header {
      position: sticky;
      top: 0;
      background: #f8f9fa;
      z-index: 3;
    }
    .sticky-col {
      position: sticky;
      left: 0;
      background: #fff;
      z-index: 2;
    }
    .sticky-corner {
        position: sticky;
        top: 0;
        left: 0;
        background: #f8f9fa;
        z-index: 4;
    }

    table {
      min-width: 1200px;
    }
    .grupo-cell {
      min-width: 140px;
    }
  </style>

        <section id="ciclos-section">
            <div id="ciclos-container">

            </div>
        </section>
        <section id="tutores-section">
            <!-- Sección de tutores -->
        </section>
        <section id="cursos-section">
            <!-- Sección de cursos -->
        </section>
    </main>

</body>
</html>
<!--
<script type="module" src="/scripts/coordinacion.js"></script>
-->

<script>
const ciclosSection = document.getElementById('ciclos-container');

const fetchedCiclos = [
    { id: 1, nombre: 'Desarrollo de Aplicaciones Web', abreviatura: 'DAW' },
    { id: 2, nombre: 'Administración de Sistemas Informáticos en Red', abreviatura: 'ASIR' },
    { id: 3, nombre: 'Sistemas Microinformáticos y Redes', abreviatura: 'SMR' }
];

const fetchedCiclosLectivos = [
    { id: 1, nombre: '2019/2020' },
    { id: 2, nombre: '2020/2021' },
    { id: 3, nombre: '2021/2022' },
    { id: 4, nombre: '2022/2023' },
    { id: 5, nombre: '2023/2024' },
    { id: 6, nombre: '2024/2025' }
];

const fetchedGrupos = [
    { id: 1, nombre: 'Primero', cicloId: 1, cicloLectivoId: 1 },
    { id: 2, nombre: 'Segundo', cicloId: 1, cicloLectivoId: 1 },
    { id: 3, nombre: 'Primero', cicloId: 2, cicloLectivoId: 1 },
    { id: 4, nombre: 'Segundo', cicloId: 2, cicloLectivoId: 1 },
    { id: 5, nombre: 'Primero', cicloId: 1, cicloLectivoId: 2 },
    { id: 6, nombre: 'Segundo', cicloId: 1, cicloLectivoId: 2 }
];

// Create table
const table = document.createElement('table');
table.className = "table table-bordered align-middle";
ciclosSection.appendChild(table);

// Build header
const thead = document.createElement('thead');
const headerRow = document.createElement('tr');
thead.appendChild(headerRow);

// Sticky ciclo header
const thCiclo = document.createElement('th');
thCiclo.textContent = "Ciclo";
thCiclo.className = "sticky-corner";
headerRow.appendChild(thCiclo);

// Add a column for each ciclo lectivo
fetchedCiclosLectivos.forEach(cl => {
    const th = document.createElement('th');
    th.textContent = cl.nombre;
    th.className = "sticky-header text-center";
    headerRow.appendChild(th);
});
table.appendChild(thead);

// Build body
const tbody = document.createElement('tbody');
table.appendChild(tbody);

fetchedCiclos.forEach(ciclo => {
    const row = document.createElement('tr');
    tbody.appendChild(row);

    // Ciclo name cell
    const tdCiclo = document.createElement('td');
    tdCiclo.textContent = ciclo.abreviatura;
    tdCiclo.className = "sticky-col fw-bold";
    row.appendChild(tdCiclo);

    // For each ciclo lectivo, fill cell with grupos
    fetchedCiclosLectivos.forEach(cl => {
        const td = document.createElement('td');
        td.className = "grupo-cell";
        // Find grupos for this ciclo and ciclo lectivo
        const grupos = fetchedGrupos.filter(g => g.cicloId === ciclo.id && g.cicloLectivoId === cl.id);
        if (grupos.length > 0) {
            grupos.forEach(g => {
                const div = document.createElement('div');
                div.className = "d-flex justify-content-between align-items-center mb-1";
                // To be replaced with createElements
                div.innerHTML = `<span>${g.nombre} ${ciclo.abreviatura}</span>
                    <button class="btn btn-sm btn-outline-primary ms-2">Editar</button>`;
                td.appendChild(div);
            });
        } else {
            td.classList.add('empty-cell');
        }
        row.appendChild(td);
    });
});

setTimeout(() => {
    ciclosSection.scrollLeft = ciclosSection.scrollWidth;
}, 0);
</script>
